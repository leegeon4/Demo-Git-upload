<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <h2>파일업로드 데모 화면2-파일여러개 업로드</h2>
    <hr>
    <form action="/galleries" method="post"
          enctype="multipart/form-data">
       <input type="text" name="title"><br/>
        <!--파일 선택 다이얼로그에서 파일형식 필터링-->
       <input type="file" accept="image/*" name="fileS"><br/>
       <input type="file" accept="image/*" name="fileS"><br/>
       <input type="file" accept="image/*" name="fileS"><br/>
       <input type="hidden" name="writer" value="iclass">
       <button type="submit">전송</button>
    </form>
    <hr/>
    <h2> Gallery List</h2>
    <p> Gallery 테이블 조회 목록(이미지 포함)</p>
    <!-- 조회된 행 개수 만큼 반복하기 list 컬렉션 요소가 하나씩 dto에 대입, status 타임리프 기능으로
        foreach 현재상태를 저장하는 프로퍼티 status.count 는 index 역할-->
    <div th:each="dto,status:${list}">
        <p>([[${status.count} ]])[[${dto.title }]],[[${dto.writer}]]</p>
        <ul style="display: flex;flex-direction: row;margin-bottom:30px;">
            <!--업로드된 파일 갯수 만큼 반복하기
                위의 th:each는 두번째 status, 변수명을 다르게 바꿀 수 있습니다. (i)
            -->
            <th:block th:each="pic,i:${#strings.setSplit(dto.fileNames,',')}">
        <!--  #strings 는 타임리프 문자열 유틸객체. 문자열을 , 분리해서 배열로 변환
              pic 는 배열요소를 1개씩 순서대로 저장. i는 foreach의 상태변수
        -->
                <li style="width:200px;height: 200px;">
                    <!-- /uploads/ url 경로는 ApplicationConfig 에서 설정합니다. -->
                    <img th:src="|@{/upload}/${pic}|"
                         th:alt="${dto.title}"
                         width="100%" height="100%" style="object-fit:cover"><br>
                    <span style="font-size: 0.7em">[[${pic}]]([[${i.index}]])</span>
                </li>
            </th:block>
        </ul>
    </div>
</body>
</html>